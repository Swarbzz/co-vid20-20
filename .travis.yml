language: ruby
rvm:
  - 2.6.3
addons:
  - postgresql: "9.6"
services:
  - postgresql
before_install:
  - gem uninstall bundler
  - gem install bundler --version '2.1.4'
  - bundle install
  - npm install
before_script:
  - bundle exec rake db:create
  - bundle exec rake db:migrate
dist: trusty
script:
  - bundle exec rspec
deploy:
  provider: heroku
  strategy: api
  api_key:
    secure: "74F79B8C79F1FB566AAFA8A2FD8CC54B571A485668AA85669D3E3804DBE675E1,31701BBEFE9828A7C4B49F43FE18BED729791AF98E729C3099558491A1C72061"
  app: community-video-2020
  on:
    repo: jamesoddy8/co-vid20-20
