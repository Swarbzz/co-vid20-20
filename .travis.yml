language: ruby
rvm:
  - 2.6.3
addons:
  - postgresql: "9.6"
services:
  - postgresql
before_install:
  - gem uninstall bundler
  - gem install bundler --version '2.1.4'
  - bundle install
  - npm install
before_script:
  - bundle exec rake db:create
  - bundle exec rake db:migrate
dist: trusty
script:
  - bundle exec rspec
deploy:
  provider: heroku
  strategy: api
  api_key:
    secure: "79b7caaf-7f59-43ac-9254-1b758ca82fdc"
  app: community-video-2020
  on:
    repo: jamesoddy8/co-vid20-20
